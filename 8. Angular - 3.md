> 2018-10-23-1703

Общую сущность для всего проекта выделяют в common или shared директорию.

Создадим директиву: `ng g d common/directives/tooltip`.

```typescript
import { Directive, Input, Renderer2, ElementRef, OnInit } from '@angular/core';

@Directive({
    selector: '[courseTooltip]'
})
export class TooltipDirective implements OnInit {
    
    // input-параметр может быть и атрибутом 
    // (а директива это атрибут)
    // назвать так же как селектор позволяет указать цель связывания
    // на название директивы
                            
    // Вообще можно ловить изменения параметра через жизненные циклы
    // Например, тот же onChange, у которого есть текущее значение, предыдущее
    
    // Но есть и setter-метод, ничего не возращает
    
    @Input()
    public set courseTooltip(text: string) {
        if (!text) {
            return;
        }
        this._tooltipContext.textContent = text;
    }
    
    // Эта штука будет работать вне зависимости от окружения (при SSR и прочем)
    private _tooltipContext: HTMLSpanElement = this._renderer.createElement('span');
    
    constructor(
         // это делается для доступа к DOM, который есть не во всех окружениях
         // Ivy на тот момент ещё не вышел
        private _renderer: Renderer2,
        
        // Через сервис есть доступ к элементу, на который повесили директиву
        private _elementRef: ElementRef
    ) {}
    
    // Срабатывает после конструктора и там хорошо бы делать связывания, определения и т.д.
    public ngOnInit() {
        // Здесь вроде как создали элемент тултипа, но ещё никуда не добавили
        this._tooltipContext.className = 'tooltiptext';
        
        // А здесь уже вставляем
        this._renderer.appendChild(this._elementRef.nativeElement, this._tooltipContext);
    }
    
    public hide(): void {
        this._tooltipContext.classList.remove('open');
    }
    
    public show(): void {
        this._tooltipContext.classList.add('open');
    }
}
```
















